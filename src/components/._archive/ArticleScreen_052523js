//ArticleScreen_052523.js

import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import { parseRequestUrl } from "../utils.js";
import { getArticleNeumadsTrail } from "../api.js";
import { BLOCKS, INLINES } from "@contentful/rich-text-types";
import { format, parseISO } from "date-fns";
import SeriesScreen from "./SeriesScreen.js";  // Replace with the actual path


const renderOptions = {
  renderNode: {
    [BLOCKS.EMBEDDED_ENTRY]: (node, children) => {
      // Adjust the code as per your actual data structure and needs
    },
    [INLINES.HYPERLINK]: (node, next) => {
      // Adjust the code as per your actual data structure and needs
    },
    [BLOCKS.EMBEDDED_ASSET]: (node, children) => {
      // Adjust the code as per your actual data structure and needs
    },
  },
};

const ArticleScreen = {
  render: async () => {
    const request = parseRequestUrl();
    const articledetails = await getArticleNeumadsTrail(request.slug);
    return articledetails.map((article) => {
      return `
      <div class="main">
        <div class="main">
          <div class="article-detail">
            <div class="article-container">
              <div class="top fullBleedContent">
                <div class="fullBleedContentHeader">
                  <div class="fullBleedContentHeaderContainer">
                    <div class="featured-image">
                      <img src="${article.hero.url}" alt="" />
                    </div>                    
                  </div>
                </div>
              </div>
              <section class="article-headline">
                <div class="article-header">
                  <div class="article-title">
                    <span class="display04">
                      ${article.title}
                    </span>
                  </div>
                  <div class="article-overview">
                    <span class="text03">
                       ${article.subtext}
                    </span>
                  </div>
                  <div class="lineH"></div>
                  <div class="article-data">
                    <div class="tag-collection">
                      <div class="featured-article-data-container">
                        <a href="/#/${article.category}">
                          <div class="section-tag" id="${article.category}">
                            <i class="section-tag-icon icon-${article.category}"></i>
                            <span class="section-tag-divider">
                            <div class="lineV"></div>
                            </span>
                            <span class="section-tag-text medium00">
                              ${article.category}
                            </span>
                          </div>
                        </a>
                      </div>
                    </div>
                  </div>
                  <div class="content">
                    <div class="article-content">
                      <span class="text03">
                        ${article.introduction ? article.introduction : ""}
                      </span>
                    </div>
                  </div>
                  <div class="article-info d-flex">
                    <span class="d-flex text01"
                      ><i class="bx bx-user"></i> Unknown</span>
                    <span class="d-flex text01"
                      ><i class="bx bx-time-five"></i> Unknown</span>
                  </div>
                  <div class="lineH"></div>
                </section>
                <div class="content content-advertisement content-advertistment-details">
                  <div class="ad-container container">
                    <div class="ad d-flex" id="ad-home">
                      <a href="/#/">
                        <img src="./images/ad_test.png" />
                      </a>
                    </div>
                  </div>
                </div>







                
                <!-- /// ARTICLE BODY /// -->
                <section class="article-body">    

                  <!-- /// ARTICLE CONTENT /// -->
                  <div class="content">
                    <div class="article-content">
                      <span class="text03">
                        ${documentToHtmlString(article.content.introduction, renderOptions)}
                      </span>
                    </div>
                    <div class="article-content">
                      <span class="text03">
                        ${documentToHtmlString(article.content.summary, renderOptions)}
                      </span>
                    </div>
                    <div class="article-content">
                      <span class="text03">
                        ${documentToHtmlString(article.content.body, renderOptions)}
                      </span>
                    </div>
                    <div class="article-content">
                      <span class="text03">
                        ${documentToHtmlString(article.content.conclusion, renderOptions)}
                      </span>
                    </div>
                    <div class="article-content">
                      <span class="text03">
                        ${documentToHtmlString(article.content.postscript, renderOptions)}
                      </span>
                    </div>
                  </div>
                  <!-- /// ARTICLE CONTENT /// -->

                  <!-- /// ARTICLE SIDEPANEL /// -->
                  <div class="content">
                    <div class="article-content">
                      <span class="header03">
                        Related Articles
                      </span>
                    </div>
                  </div>
                  <!-- /// ARTICLE CONTENT /// -->

                </section>
                <!-- /// ARTICLE BODY /// -->

              </div>

              <!--
              <div class="side-ad">
                <div class="lineH"></div>
                <a href="#" class="vertical-ad">
                  <img src="/images/side-ad.svg"/>
                </a>
              </div>
              -->

            </div>
          </div>
    `;
      }
    );
  },
  after_render: () => {
    window.scrollTo({
      top: 0,
      left: 0,
      behavior: "smooth",
    });
  },
};

export default ArticleScreen;

